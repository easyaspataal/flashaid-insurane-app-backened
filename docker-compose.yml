version: "3.9"

services:
  backend:
    build: .
    container_name: insurance-backend-prod
    # Bind only to localhost so itâ€™s not exposed publicly
    ports:
      - "127.0.0.1:10004:10004"
    env_file:
      - .env
    environment:
      - PORT=10004
      # If you want to override any .env value, add here
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "node", "-e", "require('http').get('http://localhost:10004/health', r=>process.exit(r.statusCode===200?0:1)).on('error',()=>process.exit(1))"]
      interval: 20s
      timeout: 5s
      retries: 5
      start_period: 20s
